(function(){var t,e={}.hasOwnProperty,n=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};t=Giraffe.Contrib={},t.CollectionView=function(t){function e(t){var n;if(!this.itemView)throw Error("`itemView` is required");if(!(null!=t?null!=(n=t.collection)?n.model:void 0:void 0))throw Error("`collection.model` is required");this.ItemView=this.itemView,this.listenTo(t.collection,"add",this._onAdd),this.listenTo(t.collection,"remove",this._onRemove),this.listenTo(t.collection,"reset",this._onReset),this.listenTo(t.collection,"sort",this._onSort),e.__super__.constructor.apply(this,arguments)}return n(e,t),e.prototype._onAdd=function(t){var e,n;return n=this._calcAttachOptions(t),e=new this.ItemView({model:t}),this.attach(e,n)},e.prototype._onRemove=function(t){var e;return e=_.findWhere(this.children,{model:t}),null!=e?e.dispose():void 0},e.prototype._onReset=function(){return this.removeChildren(),this.afterRender()},e.prototype._onSort=function(){return this.removeChildren(),this.afterRender()},e.prototype._calcAttachOptions=function(t){var e,n,i,r;return n={method:"prepend"},e=this.collection.indexOf(t),e>0&&(n.method="after",i=this.collection.at(e-1),r=_.findWhere(this.children,{model:i}),n.el=r),n},e.prototype.afterRender=function(){var t;return t=this,this.collection.each(function(e){return t._onAdd(e)})},e}(Giraffe.View)}).call(this);